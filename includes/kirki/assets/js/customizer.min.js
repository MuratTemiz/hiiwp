function kirkiArrayToObject(e){var t={};if(null!==e)for(var i=0;i<e.length;++i)void 0!==e[i]&&(t[i]=e[i]);return t}function kirkiObjectToArray(e){var t=[];if(null!==e)for(var i=0;i<e.length;++i)void 0!==e[i]&&t.push(e[i]);return t}function kirkiValidateCSSValue(e){var t=!0;if("0"==e)return!0;var i=["rem","em","ex","%","px","cm","mm","in","pt","pc","ch","vh","vw","vmin","vmax"],n=parseFloat(e),r=e.replace(n,"");return NaN===n&&(t=!1),-1===jQuery.inArray(r,i)&&(t=!1),t}function RepeaterRow(e,t){this.rowIndex=e,this.rowNumber=e+1,this.$el=t,this.$dragger=this.$el.find(".repeater-row-move"),this.$minimizer=this.$el.find(".repeater-row-minimize"),this.$remover=this.$el.find(".repeater-row-remove"),this.$number=this.$el.find(".repeater-row-number"),this.$fields=this.$el.find("input,select,textarea");var i=this;this.$minimizer.on("click",function(){i.toggleMinimize()}),this.$remover.on("click",function(){i.remove()}),this.$dragger.on("mousedown",function(){i.$el.trigger("row:start-dragging")}),this.$el.on("keyup change","input, select, textarea",function(e){i.$el.trigger("row:update",[i.getRowIndex(),jQuery(e.target).data("field"),e.target])}),this.renderNumber()}wp.customize.controlConstructor["kirki-checkbox"]=wp.customize.Control.extend({ready:function(){var e=this,t=e.setting._value;this.container.on("change","input",function(){t=jQuery(this).is(":checked")?!0:!1,e.setting.set(t)})}}),wp.customize.controlConstructor.code=wp.customize.Control.extend({ready:function(){var e=this,t=e.container.find("#kirki-codemirror-editor-"+e.id),i=CodeMirror.fromTextArea(t[0]);if("html"==e.params.choices.language)var n={name:"htmlmixed"};else n=e.params.choices.language;i.setOption("value",e.setting._value),i.setOption("mode",n),i.setOption("lineNumbers",!0),i.setOption("theme",e.params.choices.theme),i.setOption("height",e.params.choices.height+"px"),i.on("change",function(){e.setting.set(i.getValue())}),t.parents(".accordion-section").on("click",function(){i.refresh()})}}),wp.customize.controlConstructor["color-alpha"]=wp.customize.Control.extend({ready:function(){var e=this,t=this.container.find(".kirki-color-control"),i=t.val();t.wpColorPicker({change:function(i,n){setTimeout(function(){e.setting.set(t.val())},100)}})}}),wp.customize.controlConstructor.dimension=wp.customize.Control.extend({ready:function(){var e=this;!1===kirkiValidateCSSValue(e.setting._value)?jQuery(e.selector+" .input-wrapper").addClass("invalid"):jQuery(e.selector+" .input-wrapper").removeClass("invalid"),this.container.on("change keyup paste","input",function(){var t=jQuery(this).val();!1===kirkiValidateCSSValue(t)?jQuery(e.selector+" .input-wrapper").addClass("invalid"):(jQuery(e.selector+" .input-wrapper").removeClass("invalid"),e.setting.set(t))})}}),function($){wp.customizerCtrlEditor={init:function(){$(window).load(function(){$("textarea.wp-editor-area").each(function(){var e=$(this),t=e.attr("id"),i=tinyMCE.get(t),n,r;i&&i.onChange.add(function(t,o){t.save(),r=i.getContent(),clearTimeout(n),n=setTimeout(function(){e.val(r).trigger("change")},500)}),e.css({visibility:"visible"}).on("keyup",function(){r=e.val(),clearTimeout(n),n=setTimeout(function(){r.trigger("change")},500)})})})}},wp.customizerCtrlEditor.init()}(jQuery),wp.customize.controlConstructor["kirki-generic"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("change keyup paste",e.params.choices.element,function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.multicheck=wp.customize.Control.extend({ready:function(){var e=this;e.container.on("change","input",function(){var t=[],i=0;jQuery.each(e.params.choices,function(n,r){e.container.find('input[value="'+n+'"]').is(":checked")&&(t[i]=n,i++)}),e.setting.set(t),wp.customize.previewer.refresh()})}}),wp.customize.controlConstructor.number=wp.customize.Control.extend({ready:function(){var e=this,t=this.container.find("input");jQuery(t).spinner(),e.params.choices.min&&jQuery(t).spinner("option","min",e.params.choices.min),e.params.choices.max&&jQuery(t).spinner("option","max",e.params.choices.max),e.params.choices.step&&("any"==e.params.choices.step?jQuery(t).spinner("option","step","0.001"):jQuery(t).spinner("option","step",e.params.choices.step)),this.container.on("change click keyup paste","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.palette=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.preset=wp.customize.Control.extend({ready:function(){var e=this,t=this.container.find("select");jQuery(t).selectize(),this.container.on("change","select",function(){var t=jQuery(this).val();e.setting.set(t),jQuery.each(e.params.choices,function(e,i){t==e&&jQuery.each(i.settings,function(e,t){var i=wp.customize.settings.controls[e];if(void 0===typeof i)return!0;var n=i.type;if("checkbox"==n||"switch"==n||"toggle"==n||"kirki-checkbox"==n){var r=wp.customize.control(e).container.find("input");1==t?(jQuery(r).prop("checked",!0),wp.customize.instance(e).set(!0)):(jQuery(r).prop("checked",!1),wp.customize.instance(e).set(!1))}else if("select"==n||"select2"==n||"select2-multiple"==n||"kirki-select"==n){var r=wp.customize.control(e).container.find("select"),o=jQuery(r).selectize(),s=o[0].selectize;s.setValue(t,!0),wp.customize.instance(e).set(t)}else if("slider"==n){var r=wp.customize.control(e).container.find("input");jQuery(r).prop("value",t);var a=wp.customize.control(e).container.find(".kirki_range_value .value");jQuery(a).html(t),wp.customize.instance(e).set(t)}else if("textarea"==n||"kirki-textarea"==n){var r=wp.customize.control(e).container.find("textarea");jQuery(r).prop("value",t),wp.customize(e).set(t)}else if("color-alpha"==n||"kirki-color"==n||"color"==n){var c=wp.customize.control(e).container.find(".kirki-color-control");c.attr("data-default-color",t).data("default-color",t).wpColorPicker("color",t),wp.customize.instance(e).set(t)}else if("dimension"==n){wp.customize.instance(e).set(t);var r=wp.customize.control(e).container.find("input[type=number]"),u=parseFloat(t);jQuery(r).prop("value",u);var l=wp.customize.control(e).container.find("select"),p=t.replace(parseFloat(t),"");jQuery(l).prop("value",p)}else if("multicheck"==n)for(wp.customize.instance(e).set(t),wp.customize.control(e).container.find("input").each(function(){jQuery(this).prop("checked",!1)}),index=0;index<t.length;index++){var r=wp.customize.control(e).container.find('input[value="'+t[index]+'"]');jQuery(r).prop("checked",!0)}else if("radio-buttonset"==n||"radio-image"==n||"radio"==n||"kirki-radio"==n){var r=wp.customize.control(e).container.find('input[value="'+t+'"]');jQuery(r).prop("checked",!0),wp.customize.instance(e).set(t)}else{var r=wp.customize.control(e).container.find("input");jQuery(r).prop("value",t),wp.customize.instance(e).set(t)}})}),wp.customize.previewer.refresh()})}}),wp.customize.controlConstructor["radio-buttonset"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["radio-image"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["kirki-radio"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("change","input",function(){e.setting.set(jQuery(this).val())})}}),RepeaterRow.prototype.getRowIndex=function(){return this.rowIndex},RepeaterRow.prototype.getRowNumber=function(){return this.rowNumber},RepeaterRow.prototype.setRowNumber=function(e){this.rowNumber=e,this.renderNumber()},RepeaterRow.prototype.getElement=function(){return this.$el},RepeaterRow.prototype.setRowIndex=function(e){this.rowIndex=e,this.$el.attr("data-row",e),this.$el.data("row",e)},RepeaterRow.prototype.toggleMinimize=function(){this.$el.toggleClass("minimized"),this.$minimizer.find(".repeater-minimize").toggleClass("dashicons-arrow-up"),this.$minimizer.find(".repeater-minimize").toggleClass("dashicons-arrow-down")},RepeaterRow.prototype.minimize=function(){this.$el.addClass("minimized"),this.$minimizer.find(".repeater-minimize").removeClass("dashicons-arrow-up"),this.$minimizer.find(".repeater-minimize").addClass("dashicons-arrow-down")},RepeaterRow.prototype.remove=function(){confirm("Are you sure?")&&(this.$el.slideUp(300,function(){jQuery(this).detach()}),this.$el.trigger("row:remove",[this.getRowIndex()]))},RepeaterRow.prototype.renderNumber=function(){this.$number.text(this.getRowNumber())},wp.customize.controlConstructor.repeater=wp.customize.Control.extend({ready:function(){var e=this,t=this.params.value;if(this.settingField=this.container.find("[data-customize-setting-link]").first(),this.setValue([],!1),this.repeaterFieldsContainer=this.container.find(".repeater-fields").first(),this.currentIndex=0,this.rows=[],this.container.on("click","button.repeater-add",function(t){t.preventDefault(),e.addRow()}),this.container.on("click keypress",".repeater-field-image .upload-button",function(t){t.preventDefault(),e.$thisButton=jQuery(this),e.openFrame(t)}),this.container.on("click keypress",".repeater-field-image .remove-button",function(t){t.preventDefault(),e.$thisButton=jQuery(this),e.removeImage(t)}),this.repeaterTemplate=_.memoize(function(){var t,i={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(n){return(t=_.template(e.container.find(".customize-control-repeater-content").first().html(),null,i))(n)}}),t.length)for(var i=0;i<t.length;i++)e.addRow(t[i]);this.repeaterFieldsContainer.sortable({handle:".repeater-row-move",update:function(t,i){e.sort()}})},openFrame:function(e){wp.customize.utils.isKeydownButNotEnterEvent(e)||(this.frame||this.initFrame(),this.frame.open())},initFrame:function(){var e=this;this.frame=wp.media({states:[new wp.media.controller.Library({library:wp.media.query({type:"image"}),multiple:!1,date:!1})]}),this.frame.on("select",function(t){e.selectImage()})},selectImage:function(){var e=this.frame.state().get("selection").first().toJSON(),t=e.url,i=this.$thisButton.closest(".repeater-field-image");i.find(".kirki-image-attachment").html('<img src="'+t+'">').hide().slideDown("slow"),i.find(".hidden-field").val(t),this.$thisButton.text(this.$thisButton.data("alt-label")),i.find(".remove-button").show(),i.find("input, textarea, select").trigger("change")},removeImage:function(e){if(!wp.customize.utils.isKeydownButNotEnterEvent(e)){var t=this.$thisButton.closest(".repeater-field-image"),i=t.find(".upload-button");t.find(".kirki-image-attachment").slideUp("fast",function(){jQuery(this).show().html(jQuery(this).data("placeholder"))}),t.find(".hidden-field").val(""),i.text(i.data("label")),this.$thisButton.hide(),t.find("input, textarea, select").trigger("change")}},getValue:function(){return JSON.parse(decodeURI(this.setting.get()))},setValue:function(e,t){this.setting.set(encodeURI(JSON.stringify(e))),t&&this.settingField.trigger("change")},addRow:function(e){var t=this,i,n,r=t.repeaterTemplate(),o=this.getValue(),s={},a;if(r){if(a=jQuery.extend(!0,{},t.params.fields),e)for(i in e)e.hasOwnProperty(i)&&a.hasOwnProperty(i)&&(a[i]["default"]=e[i]);a.index=this.currentIndex,a.ControlId=this.id,r=r(a);var c=new RepeaterRow(t.currentIndex,jQuery(r).appendTo(t.repeaterFieldsContainer));c.getElement().one("row:remove",function(e,i){t.deleteRow(i)}),c.getElement().on("row:update",function(e,i,n,r){t.updateField.call(t,e,i,n,r)}),c.getElement().on("row:start-dragging",function(){for(i in t.rows)t.rows.hasOwnProperty(i)&&t.rows[i]&&t.rows[i].minimize()}),this.rows[this.currentIndex]=c;for(i in a)a.hasOwnProperty(i)&&(s[i]=a[i]["default"]);o[this.currentIndex]=s,this.setValue(o,!0),this.currentIndex++}},sort:function(){var e=this,t=this.repeaterFieldsContainer.find(".repeater-row"),i=[];t.each(function(e,t){i.push(jQuery(t).data("row"))});var n=e.getValue(),r=[],o=[];jQuery.each(i,function(t,i){r[t]=e.rows[i],r[t].setRowIndex(t),r[t].setRowNumber(t+1),o[t]=n[i]}),e.rows=r,e.setValue(o)},deleteRow:function(e){var t=this.getValue();if(t[e]){var i=this.rows[e];i&&(delete t[e],delete this.rows[e],this.setValue(t,!0))}var n=1;for(prop in this.rows)this.rows.hasOwnProperty(prop)&&this.rows[prop]&&(this.rows[prop].setRowNumber(n),n++)},updateField:function(e,t,i,n){if(this.rows[t]&&this.params.fields[i]){var r=this.params.fields[i].type,o=this.rows[t],s=this.getValue();n=jQuery(n),void 0!=typeof s[o.getRowIndex()][i]&&("checkbox"==r?s[o.getRowIndex()][i]=n.is(":checked"):s[o.getRowIndex()][i]=n.val(),this.setValue(s,!0))}}}),wp.customize.controlConstructor["kirki-select"]=wp.customize.Control.extend({ready:function(){var e=this,t=this.container.find("select"),i=parseInt(t.data("multiple"));i>1?jQuery(t).selectize({maxItems:i,plugins:["remove_button","drag_drop"]}):jQuery(t).selectize(),this.container.on("change","select",function(){if(i>1)var t=kirkiArrayToObject(jQuery(this).val());else var t=jQuery(this).val();e.setting.set(t)})}}),jQuery(document).ready(function($){$("input[type=range]").on("mousedown",function(){value=$(this).attr("value"),$(this).mousemove(function(){value=$(this).attr("value"),$(this).closest("label").find(".kirki_range_value .value").text(value)})}),$(".kirki-slider-reset").click(function(){var e=$(this).closest("label").find("input"),t=e.data("customize-setting-link"),i=e.data("reset_value");e.val(i),e.change(),$(this).closest("label").find(".kirki_range_value .value").text(i)})}),wp.customize.controlConstructor.slider=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("change","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.sortable=wp.customize.Control.extend({ready:function(){var e=this;this.settingField=this.container.find("[data-customize-setting-link]").first(),this.sortableContainer=this.container.find("ul.sortable").first(),this.setValue(this.setting.get(),!1),this.sortableContainer.sortable().disableSelection().on("sortstop",function(t,i){e.sort()}).find("li").each(function(){jQuery(this).find("i.visibility").click(function(){jQuery(this).toggleClass("dashicons-visibility-faint").parents("li:eq(0)").toggleClass("invisible")})}).click(function(){e.sort()})},sort:function(){var e=[];this.sortableContainer.find("li").each(function(){var t=jQuery(this);t.is(".invisible")||e.push(t.data("value"))}),this.setValue(e,!0)},getValue:function(){return unserialize(this.setting.get())},setValue:function(e,t){e=serialize(e),this.setting.set(e),this.settingField.val(e),t&&this.settingField.trigger("change")}}),wp.customize.controlConstructor.spacing=wp.customize.Control.extend({ready:function(){var e=this,t={};jQuery.each(["top","bottom","left","right"],function(i,n){e.container.has("."+n).size()&&(t[n]=e.setting._value[n],!1===kirkiValidateCSSValue(e.setting._value[n])?jQuery(e.selector+" ."+n+".input-wrapper").addClass("invalid"):jQuery(e.selector+" ."+n+".input-wrapper").removeClass("invalid")),e.container.has("."+n).size()&&e.container.on("change keyup paste","."+n+" input",function(){subValue=jQuery(this).val(),!1===kirkiValidateCSSValue(subValue)?jQuery(e.selector+" ."+n+".input-wrapper").addClass("invalid"):(jQuery(e.selector+" ."+n+".input-wrapper").removeClass("invalid"),t[n]=subValue,e.setting.set(t),wp.customize.previewer.refresh())})})}}),wp.customize.controlConstructor["switch"]=wp.customize.Control.extend({ready:function(){var e=this,t=e.setting._value;this.container.on("change","input",function(){t=jQuery(this).is(":checked")?!0:!1,e.setting.set(t)})}}),wp.customize.controlConstructor.toggle=wp.customize.Control.extend({ready:function(){var e=this,t=e.setting._value;this.container.on("change","input",function(){t=jQuery(this).is(":checked")?!0:!1,e.setting.set(t)})}}),wp.customize.controlConstructor.typography=wp.customize.Control.extend({ready:function(){var e=this,t=e.selector+" .font-family select",i=e.selector+" .variant select",n=e.selector+" .subset select",r={};r["font-family"]=void 0!==e.setting._value["font-family"]?e.setting._value["font-family"]:"",r["font-size"]=void 0!==e.setting._value["font-size"]?e.setting._value["font-size"]:"",r.variant=void 0!==e.setting._value.variant?e.setting._value.variant:"",r.subset=void 0!==e.setting._value.subset?e.setting._value.subset:"",r["line-height"]=void 0!==e.setting._value["line-height"]?e.setting._value["line-height"]:"",r["text-transform"]=void 0!==e.setting._value["text-transform"]?e.setting._value["text-transform"]:"",r["letter-spacing"]=void 0!==e.setting._value["letter-spacing"]?e.setting._value["letter-spacing"]:"",r.color=void 0!==e.setting._value.color?e.setting._value.color:"";var o=function(t,o,s){subSelector="variant"==o?i:n;var a=!1,c={};void 0!==jQuery(subSelector).selectize()[0]&&jQuery(subSelector).selectize()[0].selectize.destroy();for(var u=0,l=kirkiAllFonts.length;l>u;u++)t===kirkiAllFonts[u].family&&(void 0!==kirkiAllFonts[u].is_standard&&!0===kirkiAllFonts[u].is_standard&&(a=!0),c=kirkiAllFonts[u][o+"s"]);if(!1===a||"subset"!==o){if(null===s){if("variant"==o)for(var u=0,l=c.length;l>u;u++)if(void 0!==c[u].id)var p=r.variant;else{var h="regular";if(h==c[u].id)var d=!0;else if(void 0===f)var f=c[u].id}else if("subset"==o){for(var m={},u=0,l=c.length;l>u;u++)if(null!==r.subset)for(var v=0,l=r.subset.length;l>v;v++)void 0!==c[u]&&r.subset[v]==c[u].id&&(m[r.subset[v]]=r.subset[v]);if(0==m.length)p=["latin"];else{var g=jQuery.map(m,function(e,t){return[e]});p=g}}subValue=void 0!==p?p:void 0!==d?"regular":f}else subValue=s;var w;w=jQuery(subSelector).selectize({maxItems:"variant"==o?1:null,valueField:"id",labelField:"label",searchField:["label"],options:c,items:"variant"==o?[subValue]:subValue,create:!1,plugins:"variant"==o?"":["remove_button"],render:{item:function(e,t){return"<div>"+t(e.label)+"</div>"},option:function(e,t){return"<div>"+t(e.label)+"</div>"}}}).data("selectize")}"variant"==o?1===c.length||0===c.length?e.container.find(".kirki-variant-wrapper").css("display","none"):e.container.find(".kirki-variant-wrapper").css("display","block"):"subset"==o&&(0===c.length?e.container.find(".kirki-subset-wrapper").css("display","none"):e.container.find(".kirki-subset-wrapper").css("display","block")),!0===a?e.container.find(".hide-on-standard-fonts").css("display","none"):e.container.find(".hide-on-standard-fonts").css("display","block")};jQuery(t).selectize({options:kirkiAllFonts,items:[e.setting._value["font-family"]],persist:!1,maxItems:1,valueField:"family",labelField:"label",searchField:["family","label","subsets"],create:!1,render:{item:function(e,t){return"<div>"+t(e.label)+"</div>"},option:function(e,t){return"<div>"+t(e.label)+"</div>"}}}),o(r["font-family"],"variant",r.variant),o(r["font-family"],"subset",r.subset),this.container.on("change",".font-family select",function(){r["font-family"]=jQuery(this).val(),e.setting.set(r),o(jQuery(this).val(),"variant",null),o(jQuery(this).val(),"subset",null),wp.customize.previewer.refresh()}),this.container.on("change",".variant select",function(){r.variant=jQuery(this).val(),e.setting.set(r),wp.customize.previewer.refresh()}),this.container.on("change",".subset select",function(){r.subset=jQuery(this).val(),e.setting.set(r),wp.customize.previewer.refresh()}),this.container.on("change keyup paste",".font-size input",function(){r["font-size"]=jQuery(this).val(),e.setting.set(r),wp.customize.previewer.refresh()}),this.container.on("change keyup paste",".line-height input",function(){r["line-height"]=jQuery(this).val(),e.setting.set(r),wp.customize.previewer.refresh()}),this.container.on("change keyup paste",".text-transform input",function(){r["text-transform"]=jQuery(this).val(),e.setting.set(r),wp.customize.previewer.refresh()}),this.container.on("change keyup paste",".letter-spacing input",function(){r["letter-spacing"]=jQuery(this).val(),e.setting.set(r),wp.customize.previewer.refresh()});var s=this.container.find(".kirki-color-control");s.wpColorPicker({change:function(){setTimeout(function(){r.color=s.val(),e.setting.set(r),wp.customize.previewer.refresh()},100)}})}});